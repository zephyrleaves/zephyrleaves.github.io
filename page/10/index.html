
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>装逼程序员</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="淘宝文通">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="装逼程序员">
<meta property="og:url" content="http://blog.zephyrleaves.net/page/10/index.html">
<meta property="og:site_name" content="装逼程序员">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="装逼程序员">
<meta name="twitter:creator" content="@zephyrleaves">

    
    <link rel="alternative" href="/atom.xml" title="装逼程序员" type="application/atom+xml">
    
    
    <link rel="icon" href="/favicon.png">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.svg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.svg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/jacman.svg" alt="装逼程序员" title="装逼程序员"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="装逼程序员">装逼程序员</a></h1>
				<h2 class="blog-motto">无装逼不程序</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/about">关于我</a></li>
					
						<li><a href="/comment">给我留言</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
 					
						<form class="search">
							<label>Search</label>
						<input type="text" id="ts-search-input" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/30/" title="meta属性" itemprop="url">meta属性</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-30T06:41:49.000Z" itemprop="datePublished"> 发表于 2006-10-30</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>meta是用来在HTML文档中模拟HTTP协议的响应头报文。meta   标签用于网页的＜head＞与＜/head＞中，meta<br>标签的用处很多。meta<br>的属性有两种：name和http-equiv。name属性主要用于描述网页，对应于content（网页内容），以便于搜索引擎机器人查找、分类（目<br>前几乎所有的搜索引擎都使用网上机器人自动查找meta值来给网页分类）。这其中最重要的是description（站点在搜索引擎上的描述）和<br>keywords（分类关键词），所以应该给每页加一个meta值。比较常用的有以下几个：     </p>
<p>   　　name   属性   </p>
<p>   　　1、＜meta   name=&quot;Generator&quot;   content=&quot;&quot;＞用以说明生成工具（如Microsoft   FrontPage   4.0）等；   </p>
<p>   　　2、＜meta   name=&quot;KEYWords&quot;   content=&quot;&quot;＞向搜索引擎说明你的网页的关键词；   </p>
<p>   　　3、＜meta   name=&quot;DEscription&quot;   content=&quot;&quot;＞告诉搜索引擎你的站点的主要内容；   </p>
<p>   　　4、＜meta   name=&quot;Author&quot;   content=&quot;你的姓名&quot;＞告诉搜索引擎你的站点的制作的作者；   </p>
<p>   　　5、＜meta   name=&quot;Robots&quot;   content=&quot;all|none|index|noindex|follow|nofollow&quot;＞   </p>
<p>   　　其中的属性说明如下：   </p>
<p>   　　设定为all：文件将被检索，且页面上的链接可以被查询；   </p>
<p>   　　设定为none：文件将不被检索，且页面上的链接不可以被查询；   </p>
<p>   　　设定为index：文件将被检索；   </p>
<p>   　　设定为follow：页面上的链接可以被查询；   </p>
<p>   　　设定为noindex：文件将不被检索，但页面上的链接可以被查询；   </p>
<p>   　　设定为nofollow：文件将不被检索，页面上的链接可以被查询。   </p>
<p>   　　http-equiv属性   </p>
<p>   　　1、＜meta   http-equiv=&quot;Content-Type&quot;   content=&quot;text/html&quot;;charset=gb_2312-80&quot;＞   </p>
<p>   　　和   ＜meta   http-equiv=&quot;Content-Language&quot;   content=&quot;zh-CN&quot;＞用以说明主页制作所使用的文字以及语言；   </p>
<p>  　　又如英文是ISO-8859-1字符集，还有BIG5、utf-8、shift-Jis、Euc、Koi8-2等字符集；<br>　　2、＜meta   http-equiv=&quot;Refresh&quot;<br>content=&quot;n;url=<a href="http://yourlink&quot;＞定时让网页在指定的时间n内，跳转到页面http;//yourlink；" target="_blank" rel="external">http://yourlink&quot;＞定时让网页在指定的时间n内，跳转到页面http;//yourlink；</a>   </p>
<p>  　　3、＜meta   http-equiv=&quot;Expires&quot;   content=&quot;Mon,12   May   2001<br>00:20:00   GMT&quot;＞可以用于设定网页的到期时间，一旦过期则必须到服务器上重新调用。需要注意的是必须使用GMT时间格式；   </p>
<p>   　　4、＜meta   http-equiv=&quot;Pragma&quot;   content=&quot;no-cache&quot;＞是用于设定禁止浏览器从本地机的缓存中调阅页面内容，设定后一旦离开网页就无法从Cache中再调出；   </p>
<p>  　　5、＜meta   http-equiv=&quot;set-cookie&quot;   content=&quot;Mon,12   May   2001<br>00:20:00   GMT&quot;＞cookie设定，如果网页过期，存盘的cookie将被删除。需要注意的也是必须使用GMT时间格式；   </p>
<p>   　　6、＜meta   http-equiv=&quot;Pics-label&quot;   content=&quot;&quot;＞网页等级评定，在IE的internet选项中有一项内容设置，可以防止浏览一些受限制的网站，而网站的限制级别就是通过meta属性来设置的；   </p>
<p>   　　7、＜meta   http-equiv=&quot;windows-Target&quot;   content=&quot;_top&quot;＞强制页面在当前窗口中以独立页面显示，可以防止自己的网页被别人当作一个frame页调用；   </p>
<p>  　　8、＜meta   http-equiv=&quot;Page-Enter&quot;<br>content=&quot;revealTrans(duration=10,transtion=50)&quot;＞和＜meta<br>http-equiv=&quot;Page-Exit&quot;<br>contect=&quot;revealTrans(duration=20，transtion=6)&quot;＞设定进入和离开页面时的特殊效果，这个功能即<br>FrontPage中的“格式/网页过渡”，不过所加的页面不能够是一个frame页面。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术/">技术</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/AJAX/">AJAX</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/30/#comments" class="ds-thread-count comments-count-link" data-thread-key="30/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/29/" title="iBATIS的Eclipse插件Abator使用方法" itemprop="url">iBATIS的Eclipse插件Abator使用方法</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-29T14:31:52.000Z" itemprop="datePublished"> 发表于 2006-10-29</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><span style="background-color: #ffff99">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span style="background-color: #ffff99">&lt;!DOCTYPE abatorConfiguration PUBLIC &quot;-//Apache Software Foundation//DTD Abator for iBATIS Configuration 1.0//EN&quot;</span><br><span style="background-color: #ffff99">&quot;<a href="http://ibatis.apache.org/dtd/abator-config_1_0.dtd&quot;&amp;gt" target="_blank" rel="external">http://ibatis.apache.org/dtd/abator-config_1_0.dtd&quot;&amp;gt</a>;</span></p>
<p><span style="background-color: #ffff99">&lt;abatorConfiguration&gt;</span><br><span style="background-color: #ffff99">&lt;abatorContext generatorSet=&quot;Java5&quot;&gt;&lt;!– TODO: Add Database Connection Information –&gt;</span><br><span style="background-color: #ffff99">&lt;jdbcConnection driverClass=&quot;org.gjt.mm.mysql.Driver&quot;</span><br><span style="background-color: #ffff99">connectionURL=&quot;???&quot;</span><br><span style="background-color: #ffff99">userId=&quot;???&quot; password=&quot;???&quot;&gt;</span><br><span style="background-color: #ffff99">&lt;classPathEntry</span><br><span style="background-color: #ffff99">location=&quot;???&quot; /&gt;</span><br><span style="background-color: #ffff99">&lt;/jdbcConnection&gt;</span></p>
<p><span style="background-color: #ffff99">&lt;javaModelGenerator targetPackage=&quot;???&quot;</span><br><span style="background-color: #ffff99">targetProject=&quot;???&quot; /&gt;</span><br><span style="background-color: #ffff99">&lt;sqlMapGenerator targetPackage=&quot;???&quot;</span><br><span style="background-color: #ffff99">targetProject=&quot;???&quot; /&gt;</span><br><span style="background-color: #ffff99">&lt;daoGenerator type=&quot;IBATIS&quot;</span><br><span style="background-color: #ffff99">targetPackage=&quot;???&quot;</span><br><span style="background-color: #ffff99">targetProject=&quot;???&quot; /&gt;</span></p>
<p><span style="background-color: #ffff99">&lt;table schema=&quot;???&quot; tableName=&quot;???&quot;&gt;</span><br><span style="background-color: #ffff99">&lt;generatedKey identity=&quot;true&quot; column=&quot;???&quot;</span><br><span style="background-color: #ffff99">sqlStatement=&quot;???&quot; /&gt;</span><br><span style="background-color: #ffff99">&lt;columnOverride column=&quot;???&quot; javaType=&quot;java.sql.Date&quot;</span><br><span style="background-color: #ffff99">jdbcType=&quot;date&quot; /&gt;</span><br><span style="background-color: #ffff99">&lt;/table&gt;</span></p>
<p><span style="background-color: #ffff99">&lt;/abatorContext&gt;</span><br><span style="background-color: #ffcccc"><span style="background-color: #ffff99">&lt;/abatorConfiguration&gt;</span></span></p>
<p><span style="background-color: #ffffff">所有的参数都是写在</span><span style="background-color: #ffffff">&lt;abatorConfiguration&gt;这个根节点中,下面可以用</span><span style="background-color: #ffffff"> &lt;abatorContext&gt;来生成个自的iBATIS配置文件、Java Bean和DAO<br></span><span style="background-color: #ffffff">abatorContext的一个属性</span><span style="background-color: #ffffff">generatorSet有3个选项</span>Legacy、Java2、Java5</p>
<p><font size="2">Legacy：如果没有<span style="background-color: #ffffff">generatorSet属性的话，默认是</span>Legacy。但并不推荐使用Legacy因为它在生成Example类（用于查询条件）的时候有很多限制，他将查询条件写在sqlMap配置文件中，将查询值写在Example中，这样就对修改产生一些困难。<br></font></p>
<p><font size="2">Java2和Java5：他们只支持iBATIS 2.20以上的版本。在以这个模式成生的Example文件中包含了查询条件和查询值。这样修改就方便多了，对于用join的select时的查询就更方便了，自己可以定义查询条件，自由度高了很多（对于join的and查询可能还得自己修改一下Example代码）。对于or和and的应用Legacy的限制就比较大了。</font><br><span style="background-color: #ffcccc"><br></span><span style="background-color: #ffffff">&lt;jdbcConnection&gt;描述了JDBC的属性和其jar包的位置.</span></p>
<p><span style="background-color: #ffffff">&lt;javaModelGenerator&gt;、</span><span style="background-color: #ffffff"> &lt;sqlMapGenerator&gt;、</span><span style="background-color: #ffffff"> &lt;daoGenerator&gt;描述了个自生成的位置。</span><span style="background-color: #ffffff">&lt;daoGenerator&gt;中type属性则用来告诉abator生成的DAO是用于iBATIS还是</span>SPRING等容器。</p>
<p><span style="background-color: #ffffff">&lt;table&gt;告诉abator生成那个table的sqlMap。</span></p>
<p><span style="background-color: #ffffff">&lt;generatedKey&gt;来告诉abator那些列需要自动返回值（当插入的时候可以返回插入记录的主键，这对有外键的数据库极其有用）</span><span style="background-color: #ffffff">identity默认为false，则在sqlMap配置文件中&lt;selectKey&gt;的位置在sql命令前面，所以</span><span style="background-color: #ffffff">identity应该改为true。</span><span style="background-color: #ffffff">sqlStatement属性则填入</span><span style="background-color: #ffffff">各类数据库的返回值函数：</span></p>
<table border="0"><tbody><tr><th>Cloudscape</th><td>This will translate to <code>VALUES IDENTITY_VAL_LOCAL()</code></td></tr><tr><th>DB2</th><td>This will translate to <code>VALUES IDENTITY_VAL_LOCAL()</code></td></tr><tr><th>Derby</th><td>This will translate to <code>VALUES IDENTITY_VAL_LOCAL()</code></td></tr><tr><th>HSQLDB</th><td>This will translate to <code>CALL IDENTITY()</code></td></tr><tr><th>MySql</th><td>This will translate to <code>SELECT LAST_INSERT_ID()</code></td></tr><tr><th>SqlServer</th><td>This will translate to <code>SELECT SCOPE_IDENTITY()</code></td></tr></tbody></table>

<p><span style="background-color: #ffffff">&lt;columnOverride&gt;告诉abator那些列是需要特殊处理的，对于date这种比较复杂的类型，可以用它来指定映射（用jdbctype和javatype属性来指定）。</span></p>
<p>还有一些不大用的到的属性这里就不介绍了。<img src="http://public.blogbus.com/public/smiles/01-11.gif" alt=""><br><span style="background-color: #ffffff"><br></span></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术/">技术</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Java/">Java</a><a href="/tags/Eclipse/">Eclipse</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/29/#comments" class="ds-thread-count comments-count-link" data-thread-key="29/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/28/" title="在Linux中将Tomcat作为Service运行(转)" itemprop="url">在Linux中将Tomcat作为Service运行(转)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-26T13:51:29.000Z" itemprop="datePublished"> 发表于 2006-10-26</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><span style="font-weight: bold">一、创建启动/停止脚本文件<br>  </span><br>    通过一下脚本，可以使Tomcat以Service方式运行。<br><span style="font-weight: bold"><br></span></p>
<div><br>#!/bin/bash<br><br># chkconfig: 2345 10 90<br><br># description: Starts and Stops the Tomcat daemon.<br><br> TOMCAT_HOME=/usr/local/apache-tomcat-5.5.12<br> TOMCAT_START=$TOMCAT_HOME/bin/startup.sh<br>TOMCAT_STOP=$TOMCAT_HOME/bin/shutdown.sh<br><br># necessary environment variables<br><br>export<br> CATALINA_HOME=$TOMCAT_HOME<br><br>export JAVA_HOME=/usr/java/jdk1.5.0_05<br><br># source function library.<br><br>. /etc/rc.d/init.d/functions<br><br># source networking configuration.<br><br>. /etc/sysconfig/network<br><br># check that networking is up.<br><br>[ &quot;${NETWORKING}&quot; = &quot;no&quot; ] &amp;&amp; exit 0<br><br># check for tomcat script<br><br>if [ ! -f $TOMCAT_HOME/bin/catalina.sh ]<br><br>then<br>    echo &quot;Tomcat not valilable…&quot;<br><br>exit<br><br>fi<br><br>start(){<br>    echo -n &quot;Starting Tomcat: &quot;<br><br>    daemon $TOMCAT_START<br><br>    echo<br><br>    touch /var/lock/subsys/tomcat<br><br>}<br><br>stop(){<br><br>    echo -n $&quot;Shutting down Tomcat: &quot;<br><br>    daemon $TOMCAT_STOP<br><br>    rm -f /var/lock/subsys/tomcat.pid<br>    echo<br><br>}<br><br>restart(){<br>    stop<br><br>    start<br><br>}<br><br>status(){<br><br>    ps ax –width=1000 | grep<br>&quot;[o]rg.apache.catalina.startup.Bootstrap start&quot; | awk ‘{printf $1 &quot; &quot;}’<br>| wc | awk ‘{print $2}’ &gt; /tmp/tomcat_process_count.txt<br><br>    read line &lt; /tmp/tomcat_process_count.txt<br><br>    if [ $line -gt 0 ]; then<br><br>        echo -n &quot;tomcat ( pid &quot;<br><br>        ps ax –width=1000 | grep &quot;org.apache.catalina.startup.Bootstrap start&quot; | awk ‘{printf $1 &quot; &quot;}’<br><br>        echo -n &quot;) is running…&quot;<br><br>        echo<br><br>    else<br><br>        echo &quot;Tomcat is stopped&quot;<br><br>    fi<br><br>}<br><br>case &quot;$1&quot; in<br><br>    start)<br><br>        start<br>        ;;<br><br>    stop)<br><br>        stop<br>        ;;<br><br>    restart)<br><br>        stop<br><br>        sleep 3<br><br>        start<br>        ;;<br><br>    status)<br><br>        status<br>        ;;<br><br>    *)<br><br>    echo &quot;Usage: tomcatd {start|stop|restart|status}&quot;<br><br>    exit 1<br><br>esac<br><br>exit 0<br></div>

<pre><code>&lt;span style=&quot;font-weight: bold&quot;&gt;
</code></pre><p>二、保存并设置脚本文件</p>
<p>    将以上的脚本文件保存在/etc/init.d中，命名为tomcat;<br>    设置tomcat的文件属性 </p>
<pre><code>#chmod a+x tomcat
</code></pre><p><span style="font-weight: bold"><br>三、设置服务运行级别<br>    </span>最后用chkconfig设置服务运行</p>
<pre><code>#chkconfig --add tomcat
</code></pre><div> 注意：<br>  在tomcat文件的头两行的注释语句中，需要包含chkconfig和description两部分内容(确认不要拼写错误，)，否则在执行“chkconfig –add tomcat”时，会出现“<span>tomcat服务不支持chkconfig</span>”的错误提示。<br><br>  chkconfig这行表示缺省启动的运行级别以及启动和停止的优先级，如该服务缺省不再任何运行级启动，则以 - 代替运行级别。在tomcat中表示脚本在运行级2、3、4、5启动，启动优先权为10，停止优先权为90。<br><br>  description行对服务进行描述，可以用 “\” 跨行注释。<br> </div>

<p><span style="font-weight: bold"><br>参考：</span><br>[1]  <a href="http://www.mail-archive.com/tomcat-user@jakarta.apache.org/msg88796.html" target="_blank" rel="external">RE: Starting Tomcat on Linux as a Service??</a><br>[2] <a href="http://www.spaceprogram.com/knowledge/2004/01/starting-tomcat-as-service-on-linux.html" target="_blank" rel="external">Starting Tomcat as a Service on Linux</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术/">技术</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux/">Linux</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/28/#comments" class="ds-thread-count comments-count-link" data-thread-key="28/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/27/" title="歪酷Blog 镜像" itemprop="url">歪酷Blog 镜像</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-23T11:51:04.000Z" itemprop="datePublished"> 发表于 2006-10-23</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p> <a href="http://pigdogyourmother.yculblog.com" target="_blank" rel="external">http://pigdogyourmother.yculblog.com</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/生活/">生活</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/随笔/">随笔</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/27/#comments" class="ds-thread-count comments-count-link" data-thread-key="27/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/26/" title="JavaScript 原型 prototype 的使用" itemprop="url">JavaScript 原型 prototype 的使用</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-22T09:37:39.000Z" itemprop="datePublished"> 发表于 2006-10-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="函数：原型"><a href="#函数：原型" class="headerlink" title="函数：原型"></a>函数：原型</h3><p>每一个构造函数都有一个属性叫做原型(<strong>prototype</strong>,下面都不再翻译，使用其原文)。这个属性非常有用：为一个特定类声明通用的变量或者函数。</p>
<h4 id="prototype的定义"><a href="#prototype的定义" class="headerlink" title="prototype的定义"></a>prototype的定义</h4><p>你不需要显式地声明一个<var><strong>prototype</strong></var>属性，因为在每一个构造函数中都有它的存在。你可以看看下面的例子：</p>
<p><strong>Example PT1 </strong></p>
<div class="javascript"><div class="head">Language：javascript, parsed in: 0.003 seconds, using GeSHi 1.0.7.12</div>

<ol>
<li><div class="de1"><span class="kw2"><strong><font color="#003366">function</font></strong></span> Test<font color="#66cc66"><span class="br0">(</span><span class="br0">)</span></font></div></li>
<li><div class="de1"><span class="br0"><font color="#66cc66">{</font></span></div></li>
<li><div class="de1"><span class="br0"><font color="#66cc66">}</font></span></div></li>
<li><div class="de1"><span class="kw3"><font color="#000066">alert</font></span><span class="br0"><font color="#66cc66">(</font></span>Test.<span class="me1">prototype</span><span class="br0"><font color="#66cc66">)</font></span>;  <span class="co1"><em><font color="#009900">// 输出 &quot;Object&quot;</font></em></span></div></li>
<li><div class="de2"> </div></li></ol></div>



<p><a href="examplePT1("><font color="#6633ff">运行示例</font></a>;)</p>
<h4 id="给prototype添加属性"><a href="#给prototype添加属性" class="headerlink" title="给prototype添加属性"></a>给prototype添加属性</h4><p>就如你在上面所看到的，<var><strong>prototype</strong></var>是一个对象，因此，你能够给它添加属性。你添加给<var><strong>prototype</strong></var>的属性将会成为使用这个<strong>构造函数</strong>创建的对象的通用属性。</p>
<p>例如，我下面有一个数据类型<var><strong>Fish</strong></var>，我想让<strong>所有</strong>的鱼都有这些属性：<code>&lt;span title=&quot;代码&quot;&gt;&lt;font&gt;livesIn=&amp;quot;water&amp;quot;&lt;/font&gt;&lt;/span&gt;</code>和<code>&lt;span title=&quot;代码&quot;&gt;&lt;font&gt;price=20&lt;/font&gt;&lt;/span&gt;</code>；为了实现这个，我可以给构造函数<var><strong>Fish</strong></var>的<var><strong>prototype</strong></var>添加那些属性。</p>
<p><strong>Example PT2 </strong></p>
<div class="javascript"><div class="head">Language：javascript, parsed in: 0.007 seconds, using GeSHi 1.0.7.12</div>

<ol>
<li><div class="de1"><span class="kw2"><strong><font color="#003366">function</font></strong></span> Fish<span class="br0"><font color="#66cc66">(</font></span><span class="kw3"><font color="#000066">name</font></span>, color<span class="br0"><font color="#66cc66">)</font></span></div></li>
<li><div class="de1"><span class="br0"><font color="#66cc66">{</font></span></div></li>
<li><div class="de1">  <span class="kw1"><font color="#a1a100">this</font></span>.<span class="kw3"><font color="#000066">name</font></span>=<span class="kw3"><font color="#000066">name</font></span>;</div></li>
<li><div class="de1">  <span class="kw1"><font color="#a1a100">this</font></span>.<span class="me1">color</span>=color;</div></li>
<li><div class="de2"><span class="br0"><font color="#66cc66">}</font></span></div></li>
<li><div class="de1">Fish.<span class="me1">prototype</span>.<span class="me1">livesIn</span>=<span class="st0"><font color="#ff0000">&quot;water&quot;</font></span>;</div></li>
<li><div class="de1">Fish.<span class="me1">prototype</span>.<span class="me1">price</span>=<span class="nu0"><font color="#ff33ff">20</font></span>;</div></li>
<li><div class="de1"> </div></li></ol></div>



<p>接下来让我们作几条鱼：</p>
<div class="javascript"><div class="head">Language：javascript, parsed in: 0.007 seconds, using GeSHi 1.0.7.12</div>

<ol>
<li><div class="de1"><span class="kw2"><strong><font color="#003366">var</font></strong></span> fish1=<span class="kw2"><strong><font color="#003366">new</font></strong></span> Fish<span class="br0"><font color="#66cc66">(</font></span><span class="st0"><font color="#ff0000">&quot;mackarel&quot;</font></span>, <span class="st0"><font color="#ff0000">&quot;gray&quot;</font></span><span class="br0"><font color="#66cc66">)</font></span>;</div></li>
<li><div class="de1"><span class="kw2"><strong><font color="#003366">var</font></strong></span> fish2=<span class="kw2"><strong><font color="#003366">new</font></strong></span> Fish<span class="br0"><font color="#66cc66">(</font></span><span class="st0"><font color="#ff0000">&quot;goldfish&quot;</font></span>, <span class="st0"><font color="#ff0000">&quot;orange&quot;</font></span><span class="br0"><font color="#66cc66">)</font></span>;</div></li>
<li><div class="de1"><span class="kw2"><strong><font color="#003366">var</font></strong></span> fish3=<span class="kw2"><strong><font color="#003366">new</font></strong></span> Fish<span class="br0"><font color="#66cc66">(</font></span><span class="st0"><font color="#ff0000">&quot;salmon&quot;</font></span>, <span class="st0"><font color="#ff0000">&quot;white&quot;</font></span><span class="br0"><font color="#66cc66">)</font></span>;</div></li>
<li><div class="de1"> </div></li></ol></div>



<p>再来看看鱼都有哪些属性：</p>
<div class="javascript"><div class="head">Language：javascript, parsed in: 0.008 seconds, using GeSHi 1.0.7.12</div>

<ol>
<li><div class="de1"><span class="kw1"><font color="#a1a100">for</font></span> <span class="br0"><font color="#66cc66">(</font></span><span class="kw2"><strong><font color="#003366">var</font></strong></span> i=<span class="nu0"><font color="#ff33ff">1</font></span>; i&lt;=<span class="nu0"><font color="#ff33ff">3</font></span>; i++<span class="br0"><font color="#66cc66">)</font></span></div></li>
<li><div class="de1"><span class="br0"><font color="#66cc66">{</font></span></div></li>
<li><div class="de1">  <span class="kw2"><strong><font color="#003366">var</font></strong></span> fish=<span class="kw1"><font color="#a1a100">eval</font></span><span class="br0"><font color="#66cc66">(</font></span><span class="st0"><font color="#ff0000">&quot;fish&quot;</font></span>+i<span class="br0"><font color="#66cc66">)</font></span>;   <span class="co1"><em><font color="#009900">// 我只是取得指向这条鱼的指针</font></em></span></div></li>
<li><div class="de1">  <span class="kw3"><font color="#000066">alert</font></span><span class="br0"><font color="#66cc66">(</font></span>fish.<span class="kw3"><font color="#000066">name</font></span>+<span class="st0"><font color="#ff0000">&quot;,&quot;</font></span>+fish.<span class="me1">color</span>+<span class="st0"><font color="#ff0000">&quot;,&quot;</font></span>+fish.<span class="me1">livesIn</span>+<span class="st0"><font color="#ff0000">&quot;,&quot;</font></span>+fish.<span class="me1">price</span><span class="br0"><font color="#66cc66">)</font></span>;</div></li>
<li><div class="de2"><span class="br0"><font color="#66cc66">}</font></span></div></li>
<li><div class="de1"> </div></li></ol></div>



<p><a href="examplePT2("><font color="#6633ff">运行示例</font></a>;)</p>
<p>输出应该是：</p>
<div class="text"><div class="head">Language：text, parsed in: 0.001 seconds, using GeSHi 1.0.7.12</div>

<ol>
<li><div class="de1">&quot;mackarel, gray, water, 20&quot;</div></li>
<li><div class="de1">&quot;goldfish, orange, water, 20&quot;</div></li>
<li><div class="de1">&quot;salmon, white  water, 20&quot; </div></li>
<li><div class="de1"> </div></li></ol></div>



<p>&lt;</p>
<p>p&gt;你看到所有的鱼都有属性<var><strong>livesIn</strong></var>和<var><strong>price</strong></var>,我们甚至都没有为每一条不同的鱼特别声明这些属性。这时因为当一个对象被创建时，这个构造函数</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术/">技术</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/AJAX/">AJAX</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/26/#comments" class="ds-thread-count comments-count-link" data-thread-key="26/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/25/" title="Dojo 全局设置对象djConfig详解（转）" itemprop="url">Dojo 全局设置对象djConfig详解（转）</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-21T15:35:23.000Z" itemprop="datePublished"> 发表于 2006-10-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <div align="left"><pre>djConfig是dojo内置的一个全局设置对象，其作用是可以通过其控制dojo的行为</pre><pre><br><br>首先我们需要在引用dojo.js前声明djConfig对象，以便在加载dojo.js的时候才</pre><pre>能够取得所设置的值，虽然在0.3版本以后dojo支持在加载后设置，但是强烈建议你</pre><pre>把声明djConfig的代码作为第一段script</pre><pre><br><br>一个完整的djConfig对象定义如下（值均为dojo的默认值）</pre><br><div><font size="3"><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""><span>&lt;</span><span>script type</span><span>=</span><span>&quot;</span><span>text/javascript</span><span>&quot;</span><span>&gt;</span></font><span><br><font size="3"><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" alt=""><img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" alt=""></font></span><font size="3"><span>var</span><span> djConfig </span><span>=</span><span> </span><span><img src="http://www.cnblogs.com/Images/dot.gif" alt=""></span></font><span><font size="3"><span>{<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    isDebug: </span><span>false</span></font><font size="3"><span>,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    debugContainerId: </span><span>&quot;&quot;</span></font><font size="3"><span>,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    allowQueryConfig: </span><span>false</span></font><font size="3"><span>,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    baseScriptUri: </span><span>&quot;&quot;</span></font><font size="3"><span>,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    parseWidgets: </span><span>true</span></font><span><br><font size="3"><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    searchIds: [],<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    baseRelativePath: </font></span><span><font size="3">&quot;&quot;</font></span><font size="3"><span>,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    libraryScriptUri: </span><span>&quot;&quot;</span></font><font size="3"><span>,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    iePreventClobber: </span><span>false</span></font><font size="3"><span>,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    ieClobberMinimal: </span><span>true</span></font><font size="3"><span>,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" alt="">    preventBackButtonFix: </span><span>true</span></font><span><font size="3">,<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" alt="">}</font></span></span><span><font size="3">;<br><img src="http://www.cnblogs.com/Images/OutliningIndicators/None.gif" alt=""></font></span><span>&lt;/<font size="3"><span>script</span><span>&gt;</span></font></span></div><br></div>

<p>isDebug是一个很有用的属性，顾名思义，如果设置为真，则所有dojo.Debug的输出有效，开发时应该设置为true，发布时应该设置为false</p>
<p>debugContainerId同样也是与调试有关的，如果不指定的话，调试信息将会直接利用 document.write输出，这样可能会破坏页面的整体布局，所以你可以指定任何一个可以作为容器的html元素的id作为调试信息输出容器</p>
<p>allowQueryConfig，这个属性指明 dojo是否允许从页面url的参数中读取djConfig中的相关属性，当值为true时，dojo会优先从url参数中读取djConfig的其他属性，比如: <a href="http://server/dojoDemo.htm?djConfig.debugContainerId=divDebug" target="_blank" rel="external"><font color="#0000ff">http://server/dojoDemo.htm?djConfig.debugContainerId=divDebug</font></a></p>
<p>baseScriptUri，一般不需要设置，dojo会自动根据你引用dojo.js的路径设置这个值，比如，，自动获取的值便是 ../dojo/<br>ps: 如果你有多个工程需要同时引用dojo.js的话，建议也把dojo当作一个独立的工程，引用的时候采用绝对路径就可以了</p>
<p>parseWidgets，这个是可以控制dojo是否自动解析具有dojoType的html元素为对应的widget，如果你没有使用任何Widget，建议设置为false以加快dojo的加载速度</p>
<p>searchIds，这是一个字符串数组，定义了所有需要解析为widget的html元素的ID，如果ID不在其中的html元素是不会被解析的，当数组为空数组时，则所有具有dojoType的元素都会被解析</p>
<p>至于其它的属性，不是用处不大，就是不知道有什么作用</p>
<p>在实际开发中，可以把djConfig的定义放在一个js文件里，并将其作为第一个引用的js文件，这样应该是最方便的。</p>
<div></div>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术/">技术</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/AJAX/">AJAX</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/25/#comments" class="ds-thread-count comments-count-link" data-thread-key="25/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/24/" title="月光石" itemprop="url">月光石</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-21T13:15:52.000Z" itemprop="datePublished"> 发表于 2006-10-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>OVA&lt;鸦-KARAS-&gt;片尾曲<br>-月光石-</p>
<p>摇拽的灯火 瓦砾的街道<br>透明旋律载满心愿回荡着<br>燃烧殆尽的天空缓缓沉入水底<br>银色月光布满大地<br>m(<em> </em>)m<br>你的身影溶入青色夜空 恍如梦幻<br>拼命抱紧你瘦削的双肩<br>依然害怕你会转瞬消失<br>m(<em> </em>)m<br>无数的星晨 宇宙的尽头<br>初次的相遇甚至令我目眩<br>笼罩在天空洒下的绚烂光芒中<br>我们去神圣之河<br>m(<em> </em>)m<br>幸福的感觉如潮水袭来 不禁颤抖<br>希望就这样永远抱紧你<br>不愿让你消失在我眼前<br>m(<em> </em>)m<br>笼罩在天空洒下的绚烂光芒中<br>我们去向神圣之河<br>m(<em> </em>)m<br>你的身影溶入青色夜空 恍如梦幻<br>拼命抱紧你瘦削的双肩<br>依然害怕你会转瞬消失</p>
<p>幸福的感觉如潮水袭来 不禁颤抖<br>希望就这样永远抱紧你<br>不愿让你消失在我眼前</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/谈音赏乐/">谈音赏乐</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Music/">Music</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/24/#comments" class="ds-thread-count comments-count-link" data-thread-key="24/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/569/" title="可怜的本命年" itemprop="url">可怜的本命年</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-19T13:16:44.000Z" itemprop="datePublished"> 发表于 2006-10-19</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>都说本命年是不祥之年，我本不迷信，不相信这种东西。不过本命年真的很晦气啊。唉！</p>
<p>数数今年遇到的晦气事：</p>
<p><span style="color: #990099">1.房子住了半年，突然房东说要装修。硬把我赶出来，差点无家可归。可怜！</span></p>
<p><span style="color: #990099">2.从不丢三落四的我居然把手机给丢了，损失了一大把数据，还得花大把Money去买个新的，可怜！</span></p>
<p><span style="color: #990099">3.现在住的房子电路老化，得换电线，在没钱的时候又得花大钱，穷的可怜！</span></p>
<p><span style="color: #990099">4.在单位累死累活，头头就是不给我谈合同加工资，温饱就快成问题。大大的可怜！</span></p>
<p><span style="color: #000000">发发牢骚心情好一点，不知道什么时候能走运，什么时候心情能好点，什么时候能大把大把地数钱！hoho</span></p>
<p>还是去灵隐烧烧香吧！</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/生活/">生活</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/随笔/">随笔</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/569/#comments" class="ds-thread-count comments-count-link" data-thread-key="569/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/22/" title="Jakata Poi HSSF：纯java的Excel解决方案 (转)" itemprop="url">Jakata Poi HSSF：纯java的Excel解决方案 (转)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-18T04:18:11.000Z" itemprop="datePublished"> 发表于 2006-10-18</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><span></span></p>
<div>微软在桌面系统上的成功，令我们不得不大量使用它的办公产品，如：Word，Excel。时至今日，它的源代码仍然不公开已封锁了我们的进一步应用和开发。然而在要求更高的服务器领域，微软本身的产品移植性不好，性能不佳。<br><br>在我们实际的开发中，表现层的解决方案虽然有多样，但是IE浏览器已成为最多人使用的浏览器，因为大家都用Windows。在企业办公系统中，常常有客户这样子要求：你要把我们的报表直接用Excel打开。<br><br>或者是：我们已经习惯用Excel打印。这样子如果用.net开发是没有问题的，但是有J2EE这个比.net更有前途的开放式的开发环境，难道我为了解决打印的要求去另写客户端的控件？或者在服务器端使用本地代码？第一种方案的问题是关键数据的处理有时候不能在客户端做，第2种方案的问题是牺牲了代码的可移植性和稳定性。如果让客户端只负责处理生成好的报表，那将是一种诱人的选择。<br><br>Apache的Jakata项目的POI子项目，目标是处理ole2对象。目前比较成熟的是HSSF接口，处理MS Excel（97-2002）对象。它不象我们仅仅是用csv生成的没有格式的可以由 Excel转换的东西，而是真正的Excel对象，你可以控制一些属性如sheet,cell等等。<br><br>这是一个年轻的项目，所以象HDF这样直接支持Word对象的好东西仍然在设计中。其它支持word格式的纯Java方案还有itext，不过也是仍在奋斗中。但是HSSF已经成熟到能够和足够我们使用了。<br><br>其实，从开发历史的角度讲，在80年代中期starOffice的原作者在德国成立了StarOffice suite公司，然后到1999年夏天 starOffice被sun收购，再到2000年6月starOffice5.2的发布；并且从starOffice6.0开始，starOffice 建立在OpenOffice的api的基础上，这个公开代码的office项目已经进行了很长的时间。虽然那是由C++写的，但是POI的代码部分也是由 openOffice改过来的。所以，应该对POI充满足够的信心。国内已经有部分公司在他们的办公自动化等Web项目中使用poi了，如日恒的 ioffice，海泰的HTOffice等。<br><br>Java当初把核心处理设成Unicode，带来的好处是另代码适应了多语言环境。然而由于老外的英语只有26个字母，有些情况下，一些程序员用8位的byte处理，一不小心就去掉了CJK的高位。或者是由于习惯在程序中采用硬编码，还有多种原因，使得许多Java应用在CJK的处理上很烦恼。还好在POI HSSF中考虑到这个问题，可以设置encoding为双字节。<br><br>POI可以到www.apache.org下载到。编译好的jar主要有这样4个：poi包,poi Browser包,poi hdf包,poi hssf例程包。实际运行时，需要有poi包就可以了。<br><br>如果用Jakarta ant编译和运行，下载apache Jakarta POI的release中的src包，它里面已经为你生成好了build文件了。只要运行ant就可以了(ant 的安装和使用在此不说了)。如果是用Jbuilder 运行，请在新建的项目中加入poi包。<br><br>以Jbuilder6 为例，选择Tools菜单项的config libraries…选项，新建一个lib。在弹出的菜单中选择poi包，如这个jakarta-poi -1.5.1-final-20020820.jar，把poi添加到jbuilder中。然后，右键点击你的项目，在project的 properties菜单中path的required Libraries中，点add，添加刚才加入到jbuilder中的poi到你现在的项目中。<br><br>如果你仅仅是为了熟悉POI hssf的使用，可以直接看POI的samples包中的源代码，并且运行它。hssf的各种对象都有例程的介绍。hssf提供的例程在org.apache.poi.hssf.usermodel.examples包中，共有14个，生成的目标xls都是 workbook.xls。如果你想看更多的例程，可以参考hssf的Junit test cases，在poi的包的源代码中有。hssf都有测试代码。<br>这里只对部分例程的实现做介绍。<br><br>HSSF提供给用户使用的对象在org.apache.poi.hssf.usermodel包中,主要部分包括Excell对象，样式和格式，还有辅助操作。有以下几种对象：<br><br>HSSFWorkbook excell的文档对象<br><br>HSSFSheet excell的表单<br><br>HSSFRow excell的行<br><br>HSSFCell excell的格子单元<br><br>HSSFFont excell字体<br><br>HSSFName 名称<br><br>HSSFDataFormat 日期格式<br><br>在poi1.7中才有以下2项：<br><br>HSSFHeader sheet头<br><br>HSSFFooter sheet尾<br><br>和这个样式<br><br>HSSFCellStyle cell样式<br><br>辅助操作包括<br><br>HSSFDateUtil 日期<br><br>HSSFPrintSetup 打印<br><br>HSSFErrorConstants 错误信息表<br><br>仔细看org.apache.poi.hssf包的结构，不难发现HSSF的内部实现遵循的是MVC模型。<br><br>这里我用Rose把org.apache.poi.hssf.usermodel包中的对象反向导入并根据相互关系作了整理，详见下面两图：<br><br></div>

<div align="center"><img src="http://tech.ccidnet.com/pub/attachment/2005/7/470489.jpg" alt=""></div>

<div><br><br></div>

<div align="center">图1 基本对象</div>

<div><br><br>从中不难可以发现每一个基本对象都关联了一个Record对象。Record对象是一个参考Office格式的相关记录。<br><br></div>

<div align="center"><img src="http://tech.ccidnet.com/pub/attachment/2005/7/470491.jpg" alt=""></div>

<div><br><br></div>

<div align="center">图2 HSSFWorkbook</div>

<div><br><br>HSSFWorkbook即是一个Excell对象。这幅类图体现的是HSSFWorkbook和基本对象的相互关系。可见，许多对象中也建立了Workbook的引用。还需要注意的是在HSSFWorkbook和HSSFSheet中建立了log机制 POILogger，而且POILogger也是使用apache Log4J实现的。<br><br>先看poi的examples包中提供的最简单的例子，建立一个空xls文件。<br><br>import org.apache.poi.hssf.usermodel.HSSFWorkbook;<br><br>import java.io.FileOutputStream;<br><br>import java.io.IOException;<br><br>public class NewWorkbook<br><br>{<br><br>public static void main(String[] args)<br><br>throws IOException<br><br>{<br><br>HSSFWorkbook wb = new HSSFWorkbook();<br>//建立新HSSFWorkbook对象<br><br>FileOutputStream fileOut =<br>new FileOutputStream(&quot;workbook.xls&quot;）;<br><br>wb.write(fileOut);<br>//把Workbook对象输出到文件workbook.xls中<br><br>fileOut.close();<br><br>}<br><br>}<br><br>通过这个例子，我们建立的是一个空白的xls文件（不是空文件）。在此基础上，我们可以进一步看其它的例子。<br><br>import org.apache.poi.hssf.usermodel.*;<br><br>import java.io.FileOutputStream;<br><br>import java.io.IOException;<br><br>public class CreateCells<br><br>{<br><br>public static void main(String[] args)<br><br>throws IOException<br><br>{<br><br>HSSFWorkbook wb = new HSSFWorkbook();<br>//建立新HSSFWorkbook对象<br><br>HSSFSheet sheet = wb.createSheet(&quot;new sheet&quot;）;<br>//建立新的sheet对象<br><br>// Create a row and put some cells in it.<br>Rows are 0 based.<br><br>HSSFRow row = sheet.createRow((short)0);<br>//建立新行<br><br>// Create a cell and put a value in it.<br><br>HSSFCell cell = row.createCell((short)0);<br>//建立新cell<br><br>cell.setCellvalue(1);//设置cell的整数类型的值<br><br>// Or do it on one line.<br><br>row.createCell((short)1).setCellvalue(1.2);<br>//设置cell浮点类型的值<br><br>row.createCell((short)2).setCellvalue(&quot;test&quot;）;<br>//设置cell字符类型的值<br><br>row.createCell((short)3).setCellvalue(true)<br>;<br>//设置cell布尔类型的值<br><br>HSSFCellStyle cellStyle = wb.createCellStyle();<br>//建立新的cell样式<br><br>cellStyle.setDataFormat<br>(HSSFDataFormat.getFormat(&quot;m/d/yy h:mm&quot;））;<br>//设置cell样式为定制的日期格式<br><br>HSSFCell dCell =row.createCell((short)4);<br><br>dCell.setCellvalue(new Date());<br>//设置cell为日期类型的值<br><br>dCell.setCellStyle(cellStyle);<br>//设置该cell日期的显示格式<br><br>HSSFCell csCell =row.createCell((short)5);<br><br>csCell.setEncoding(HSSFCell.ENCODING_UTF_16);<br>//设置cell编码解决中文高位字节截断<br><br>csCell.setCellvalue(&quot;中文测试_Chinese Words Test&quot;）;<br>//设置中西文结合字符串<br><br>row.createCell((short)6).setCellType<br>(HSSFCell.CELL_TYPE_ERROR);<br>//建立错误cell<br><br>// Write the output to a file<br><br>FileOutputStream fileOut =<br>new FileOutputStream(&quot;workbook.xls&quot;）;<br><br>wb.write(fileOut);<br><br>fileOut.close();<br><br>}<br><br>}<br><br>我稍微修改了原来的examples包中的CreateCells类写了上面的功能测试类。通过这个例子，我们可以清楚的看到xls文件从大到小包括了 HSSFWorkbook HSSFSheet HSSFRow HSSFCell这样几个对象。我们可以在cell中设置各种类型的值。<br><br>尤其要注意的是如果你想正确的显示非欧美的字符时，尤其象中日韩这样的语言，必须设置编码为16位的即是HSSFCell.ENCODING_UTF_16，才能保证字符的高8位不被截断而引起编码失真形成乱码。<br><br>其他测试可以通过参考examples包中的测试例子掌握poi的详细用法，包括字体的设置，cell大小和低纹的设置等。需要注意的是POI是一个仍然在完善中的公开代码的项目，所以有些功能正在不断的扩充。<br><br>如HSSFSheet 的getFooter() getHeader()和setFooter(HSSFFooter hsf) setHeader (HSSFHeader hsh)是在POI1.7中才有的，而POI1.5中就没有。运行测试熟悉代码或者使用它做项目时请注意POI的版本。<br><br>另外需要注意的是HSSF也有它的对xls基于事件的解析。可以参考例程中的EventExample.java。它通过实现HSSFListener完成从普通流认知Xls中包含的内容，在apache Cocoon中的 org.apache.cocoon.serialization.HSSFSerializer中用到了这个解析。因为Cocoon2是基于事件的，所以POI为了提供快速的解析也提供了相应的事件。当然我们自己也可以实现这个事件接口。<br><br>因为POI还不是一个足够成熟的项目，所以有必要做进一步的开发和测试。但是它已经为我们用纯Java操作ole2对象提供了可能，而且克服了ole对象调用的缺陷，提供了服务器端的Excel解决方案。 </div>

<div> </div>

<div><strong>在Java中读写Excel文件</strong></div>

<div>Jakarta的POI项目提供了一组操纵Windows文档的Java API，如下几个类提供了操作Excel文件的方便的途径： HSSFWorkbook、HSSFSheet、HSSFRow、HSSFCell，分别代表了Excel电子表格中的Book、Sheet、行和单元格。<br>你可以在下面地址下载到最新的POI工具包：<br>    <a href="http://jakarta.apache.org/poi/index.html" target="_blank" rel="external"><u><font color="#0000ff">http://jakarta.apache.org/poi/index.html</font></u></a><br>下面的代码创建一个Excel文件test.xls，并在第一行的第一格中写入一条消息：<br><br><div><br><br>1.  <strong><font color="#0000ff">import</font></strong> org.apache.poi.hssf.usermodel.<em>;2.  <strong><font color="#0000ff">import</font></strong> java.io.<strong><a href="http://www.javaresearch.org/source/jdk142/java/io/FileOutputStream.java.html" target="_blank" rel="external"><font color="#0000ff"><u>FileOutputStream</u></font></a></strong>;3.  <li>_<font color="#339900">// code run against the jakarta-poi-1.5.0-FINAL-20020506.jar.</font>_4.  <strong><font color="#0000ff">public</font></strong> <strong><font color="#0000ff">class</font></strong> PoiTest {5.  </li><li>    <strong><font color="#0000ff">static</font></strong> <strong><font color="#0000ff">public</font></strong> <strong><font color="#0000ff">void</font></strong> main(<strong><a href="http://www.javaresearch.org/source/jdk142/java/lang/String.java.html" target="_blank" rel="external"><font color="#0000ff"><u>String</u></font></a></strong>[] args) <strong><font color="#0000ff">throws</font></strong> <strong><a href="http://www.javaresearch.org/source/jdk142/java/lang/Exception.java.html" target="_blank" rel="external"><font color="#0000ff"><u>Exception</u></font></a></strong> {6.  <strong><a href="http://www.javaresearch.org/source/jdk142/java/io/FileOutputStream.java.html" target="_blank" rel="external"><font color="#0000ff"><u>FileOutputStream</u></font></a></strong> fos = <strong><font color="#0000ff">new</font></strong> <strong><a href="http://www.javaresearch.org/source/jdk142/java/io/FileOutputStream.java.html" target="_blank" rel="external"><font color="#0000ff"><u>FileOutputStream</u></font></a></strong>(<font color="#ff33ff">&quot;d:\test.xls&quot;</font>);7.  HSSFWorkbook wb = <strong><font color="#0000ff">new</font></strong> HSSFWorkbook();8.  HSSFSheet s = wb.createSheet();9.  wb.setSheetName(0, <font color="#ff33ff">&quot;first sheet&quot;</font>);10.  HSSFRow row = s.createRow(0);11.  HSSFCell cell = row.createCell(0);12.  cell.setCellValue(<font color="#ff33ff">&quot;Hello! This message is generated from POI.&quot;</font>);13.  wb.write(fos);14.  fos.close();15.  }16.  </li><li>}</li></em></div><br>读取Excel文件时，首先生存一个POIFSFileSystem对象，由POIFSFileSystem对象构造一个HSSFWorkbook，该HSSFWorkbook对象就代表了Excel文档。下面代码读取上面生成的Excel文件写入的消息字串：<br><div><br><br>1.  POIFSFileSystem fs = <strong><font color="#0000ff">null</font></strong>;2.  HSSFWorkbook wb = <strong><font color="#0000ff">null</font></strong>;3.  <li>    <strong><font color="#0000ff">try</font></strong> {4.  fs = <strong><font color="#0000ff">new</font></strong> POIFSFileSystem(<strong><font color="#0000ff">new</font></strong> <font color="#ff0000">FileInputStream</font>(<font color="#ff33ff">&quot;d:\test.xls&quot;</font>));5.  wb = <strong><font color="#0000ff">new</font></strong> HSSFWorkbook(fs);6.  } <strong><font color="#0000ff">catch</font></strong> (<font color="#ff0000">IOException</font> e) {7.  e.printStackTrace();8.  }9.  HSSFSheet sheet = wb.getSheetAt(0);  ////获取第一张Sheet表10.  HSSFRow row = sheet.getRow(0);  // 第1行11.  HSSFCell cell = row.getCell((<strong><font color="#0000ff">short</font></strong>) 0); // 第1列的单元格12.  <em>*<a href="http://www.javaresearch.org/source/jdk142/java/lang/String.java.html" target="_blank" rel="external"><font color="#0000ff"><u>String</u></font></a></em> msg = cell.getStringCellValue();</li></div></div>

<p></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术/">技术</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Java/">Java</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/22/#comments" class="ds-thread-count comments-count-link" data-thread-key="22/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/21/" title="Linux下安装WebSphere Application Server" itemprop="url">Linux下安装WebSphere Application Server</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="淘宝文通" target="_blank" itemprop="author">淘宝文通</a>
		
  <p class="article-time">
    <time datetime="2006-10-16T01:45:10.000Z" itemprop="datePublished"> 发表于 2006-10-16</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p></p><p class="MsoNormal"><span lang="EN-US"><span>1.<span>       </span></span></span><span>下载<span lang="EN-US">WebSphere Application Server</span>安装包。然后解压到任意目录下（建议<span lang="EN-US">/usr/local</span>下）。<span lang="EN-US"><p></p></span></span></p>
<p></p><p class="MsoNormal"><span lang="EN-US"><span>2.<span>       </span></span></span><span>开始安装<span lang="EN-US">WebSphere Application Server</span>。需要在图形界面下完成安装（如果出现乱码，可参考<a href="http://canyousee.blogbus.com/logs/2006/10/3589065.html" target="_blank" rel="external">linux下java中文字体问题</a>这篇文章）。在<span lang="EN-US">/WASinstall/WAS</span>目录下键入<span lang="EN-US">./install</span>开始安装。<span lang="EN-US"><p></p></span></span></p>
<p></p><p class="MsoNormal"><span lang="EN-US"><span>3.<span>       </span></span></span><span>安装过程中一路的选择<span lang="EN-US">NEXT</span>，途中可选择安装目录，若选择自定义安装的话，还需配置默认概要表的第一服务器各个端口。然后<span lang="EN-US">finish</span>完成安装。<span lang="EN-US"><p></p></span></span></p>
<p></p><p class="MsoNormal"><span lang="EN-US"><span>4.<span>       </span></span></span><span>安装完成后，会自动弹出<span lang="EN-US">PCT</span>的概要表生成向导，可用来生成新的概要表。也可以运行<span lang="EN-US">bin/ProfileCreator</span>目录下的<span lang="EN-US">pctLinux.bin</span>程序启动概要表生成向导<span lang="EN-US">.(</span>需要在图形界面下<span lang="EN-US">)<p></p></span></span></p>
<p></p><p class="MsoNormal"><span lang="EN-US"><span>5.<span>       </span></span></span><span>在<span lang="EN-US"><a href="http://host:9906/ibm/consolez" target="_blank" rel="external">http://host:9906/ibm/consolez</a></span>中进入控制台进行配置<span lang="EN-US">(</span>默认<span lang="EN-US">)<p></p></span></span></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/技术/">技术</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux/">Linux</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/21/#comments" class="ds-thread-count comments-count-link" data-thread-key="21/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/9/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/11/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/学海无涯/" title="学海无涯">学海无涯<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/技术/" title="技术">技术<sup>91</sup></a></li>
		  
		
		  
			<li><a href="/categories/游戏人生/" title="游戏人生">游戏人生<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活/" title="生活">生活<sup>13</sup></a></li>
		  
		
		  
			<li><a href="/categories/管理/" title="管理">管理<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/谈音赏乐/" title="谈音赏乐">谈音赏乐<sup>6</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>38</sup></a></li>
			
		
			
				<li><a href="/tags/随笔/" title="随笔">随笔<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/C-C/" title="C/C++">C/C++<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/AJAX/" title="AJAX">AJAX<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/Eclipse/" title="Eclipse">Eclipse<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/InnoDB/" title="InnoDB">InnoDB<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/数据库/" title="数据库">数据库<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/Web应用/" title="Web应用">Web应用<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Objective-C/" title="Objective-C">Objective-C<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Music/" title="Music">Music<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/无线/" title="无线">无线<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Flex/" title="Flex">Flex<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/RCP/" title="RCP">RCP<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/iOS/" title="iOS">iOS<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Groovy/" title="Groovy">Groovy<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Cache/" title="Cache">Cache<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/开源/" title="开源">开源<sup>2</sup></a></li>
			
		
		</ul>
</div>


  
<div class="commentslist">
  <p class="asidetitle">最近评论</p>
  <ul class="ds-recent-comments" data-num-items="5" data-show-avatars="1" data-show-time="1" data-show-admin="1" data-excerpt-length="32" data-show-title="1"></ul>
</div>
<!--多说js加载开始，一个页面只需要加载一次 -->
<script type="text/javascript">
  var duoshuoQuery = {short_name:"zephyrleaves"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!--多说js加载结束，一个页面只需要加载一次 -->


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Kevin Huang in Alibaba. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/1715949742" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/zephyrleaves" target="_blank" class="icon-github" title="github"></a>
		
		
		
		<a href="https://twitter.com/zephyrleaves" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/kevin.huang.33046" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		<a href="https://www.linkedin.com/in/zephyrleaves" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		
		
		
		<a href="mailto:zephyrleaves@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="淘宝文通">淘宝文通</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"zephyrleaves"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?caf9488f7d7075299a8a32597f11861d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<script>
var option = {
  engineKey: '33705c4343bfcd5aed49'
};
(function(w,d,t,u,n,s,e){
  s = d.createElement(t);
  s.src = u;
  s.async = 1;
  w[n] = function(r){
    w[n].opts = r;
  };
  e = d.getElementsByTagName(t)[0];
  e.parentNode.insertBefore(s, e);
})(window,document,'script','//tinysou-cdn.b0.upaiyun.com/ts.js','_ts');
_ts(option);
</script>

<!-- Tiny_search End -->

  </body>
 </html>
